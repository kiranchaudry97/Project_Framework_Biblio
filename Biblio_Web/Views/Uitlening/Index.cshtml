@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer
@model IEnumerable<Biblio_Models.Entiteiten.Lenen>
@{
    ViewData["Title"] = Localizer["Title"];
}

<h1>@Localizer["Title"]</h1>

<form method="get" class="row g-2 mb-2">
    <div class="col-auto">
        <select name="lidId" class="form-select">
            <option value="">@Localizer["AllMembers"]</option>
            @foreach(var l in ViewBag.Leden as List<Biblio_Models.Entiteiten.Lid> ?? new List<Biblio_Models.Entiteiten.Lid>())
            {
                <option value="@l.Id">@l.Voornaam @l.AchterNaam</option>
            }
        </select>
    </div>
    <div class="col-auto">
        <select name="boekId" class="form-select">
            <option value="">@Localizer["AllBooks"]</option>
            @foreach(var b in ViewBag.Boeken as List<Biblio_Models.Entiteiten.Boek> ?? new List<Biblio_Models.Entiteiten.Boek>())
            {
                <option value="@b.Id">@b.Titel</option>
            }
        </select>
    </div>
    <div class="col-auto form-check">
        <input type="checkbox" name="onlyOpen" class="form-check-input" />
        <label class="form-check-label">@Localizer["OnlyOpen"]</label>
    </div>
    <div class="col-auto">
        <button class="btn btn-primary">@Localizer["Filter"]</button>
    </div>
    <div class="col-auto">
        @if (User.IsInRole("Admin") || User.IsInRole("Medewerker"))
        {
            <a class="btn btn-success" asp-action="Create">@Localizer["New"]</a>
        }
    </div>
</form>

<table class="table table-striped">
    <thead>
        <tr>
            <th>@Localizer["Member"]</th>
            <th>@Localizer["Book"]</th>
            <th>@Localizer["Start"]</th>
            <th>@Localizer["Due"]</th>
            <th>@Localizer["Returned"]</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
@foreach(var u in Model)
{
    <tr>
        <td>@u.Lid?.Voornaam @u.Lid?.AchterNaam</td>
        <td>@u.Boek?.Titel</td>
        <td>@u.StartDate:d</td>
        <td>@u.DueDate:d</td>
        <td>@(u.ReturnedAt?.ToString("d") ?? "-")</td>
        <td>
            <a class="btn btn-sm btn-info" asp-action="Details" asp-route-id="@u.Id">@Localizer["Details"]</a>
            @if (User.IsInRole("Admin") || User.IsInRole("Medewerker"))
            {
                @if (u.ReturnedAt == null)
                {
                    <a class="btn btn-sm btn-success" asp-action="Return" asp-route-id="@u.Id">@Localizer["Return"]</a>
                }
                <a class="btn btn-sm btn-danger" asp-action="Delete" asp-route-id="@u.Id">@Localizer["Delete"]</a>
            }
        </td>
    </tr>
}
    </tbody>
</table>
