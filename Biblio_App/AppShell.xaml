<?xml version="1.0" encoding="utf-8" ?>
<Shell
    x:Class="Biblio_App.AppShell"
    x:Name="This"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:pages="clr-namespace:Biblio_App.Pages"
    xmlns:local="clr-namespace:Biblio_App"
    Title="Biblio"
    FlyoutBehavior="Flyout"
    FlyoutWidth="280"
    FlyoutBackgroundColor="{StaticResource Primary}"
    Shell.TabBarIsVisible="False">

    <Shell.Resources>
        <!-- Maak flyout item tekst zichtbaar met goed contrast -->
        <Color x:Key="ShellForegroundColor">#FFFFFF</Color>
        <Color x:Key="ShellUnselectedColor">#CCCCCC</Color>
        <Color x:Key="ShellTitleColor">#FFFFFF</Color>
        <Color x:Key="ShellBackgroundColor">#1e3050</Color>
        
        <SolidColorBrush x:Key="ShellForegroundBrush" Color="#FFFFFF" />
        
        <!-- Stijl voor Shell om ervoor te zorgen dat hamburger icoon zichtbaar is -->
        <Style TargetType="Shell" ApplyToDerivedTypes="True">
            <Setter Property="Shell.ForegroundColor" Value="White" />
            <Setter Property="Shell.BackgroundColor" Value="{StaticResource Primary}" />
            <Setter Property="Shell.TitleColor" Value="White" />
        </Style>
        
        <!-- FlyoutItem styling -->
        <Style TargetType="FlyoutItem">
            <Setter Property="Shell.BackgroundColor" Value="{StaticResource Primary}" />
            <Setter Property="Shell.ForegroundColor" Value="White" />
            <Setter Property="Shell.TitleColor" Value="White" />
        </Style>
    </Shell.Resources>

    <!-- Flyout header met titel en thema toggle (taal picker verwijderd - gebruik Instellingen pagina) -->
    <Shell.FlyoutHeader>
        <Grid Padding="12" BackgroundColor="{StaticResource Primary}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <Label Text="{Binding BiblioTitle, Source={x:Reference This}}" 
                   FontAttributes="Bold" 
                   FontSize="18" 
                   VerticalOptions="Center" 
                   TextColor="White" />

            <!-- Thema toggle knop met betere zichtbaarheid -->
            <Border Grid.Column="1"
                    StrokeThickness="2"
                    Stroke="White"
                    BackgroundColor="#27416a"
                    Padding="0"
                    WidthRequest="44"
                    HeightRequest="44"
                    Margin="8,0"
                    StrokeShape="RoundRectangle 8">
                <Button x:Name="ThemeToggleButton" 
                        Text="â˜€"
                        FontSize="24"
                        FontAttributes="Bold"
                        Clicked="OnThemeToggleClicked" 
                        BackgroundColor="Transparent"
                        TextColor="White"
                        Padding="0"
                        WidthRequest="44"
                        HeightRequest="44"
                        BorderWidth="0" />
            </Border>

        </Grid>
    </Shell.FlyoutHeader>

    <!-- Gebruik emoji prefixes als lichtgewicht iconen zodat geen extra afbeeldingsbestanden vereist zijn -->
    <FlyoutItem Title="{Binding MenuTitle, Source={x:Reference This}}" FlyoutDisplayOptions="AsMultipleItems">
        <!-- voeg expliciete Route toe zodat we kunnen navigeren via absolute route naar het flyout item -->
        <ShellContent x:Name="BooksShell" Route="BoekenShell" 
                      Title="{Binding BooksShellTitle, Source={x:Reference This}}" 
                      Icon="ðŸ“š"
                      ContentTemplate="{DataTemplate pages:BoekenPagina}" />
        <ShellContent x:Name="MembersShell" 
                      Title="{Binding MembersShellTitle, Source={x:Reference This}}" 
                      Icon="ðŸ‘¥"
                      ContentTemplate="{DataTemplate pages:LedenPagina}" />
        <ShellContent x:Name="LoansShell" 
                      Title="{Binding LoansShellTitle, Source={x:Reference This}}" 
                      Icon="ðŸ“–"
                      ContentTemplate="{DataTemplate pages:UitleningenPagina}" />
        <ShellContent x:Name="CategoriesShell" 
                      Title="{Binding CategoriesShellTitle, Source={x:Reference This}}" 
                      Icon="ðŸ·ï¸"
                      ContentTemplate="{DataTemplate pages:CategorieenPagina}" />
        <ShellContent x:Name="SettingsShell" 
                      Title="{Binding SettingsShellTitle, Source={x:Reference This}}" 
                      Icon="âš™ï¸"
                      ContentTemplate="{DataTemplate pages:InstellingenPagina}" />
    </FlyoutItem>

    <!-- Profiel / account menu items -->
    <MenuItem x:Name="ProfileMenuItem" 
              Text="{Binding ProfileMenuText, Source={x:Reference This}}" 
              IconImageSource="ðŸ‘¤"
              Clicked="OnProfileClicked" />
    <MenuItem x:Name="LogoutMenuItem" 
              Text="{Binding LogoutMenuText, Source={x:Reference This}}" 
              IconImageSource="ðŸšª"
              Clicked="OnLogoutClicked" />

    <!-- Snelle acties in de flyout footer -->
    <Shell.FlyoutFooter>
        <VerticalStackLayout Padding="12" Spacing="8" BackgroundColor="{StaticResource Primary}">
            <Label x:Name="QuickLabel" Text="{Binding QuickLabelText, Source={x:Reference This}}" FontSize="14" TextColor="{StaticResource White}" />
            <Button Text="{Binding QuickNewBookButtonText, Source={x:Reference This}}" BackgroundColor="{StaticResource Primary}" TextColor="{StaticResource White}" Clicked="QuickNewBook_Clicked" x:Name="QuickNewBookButton" />
            <Button Text="{Binding QuickNewMemberButtonText, Source={x:Reference This}}" BackgroundColor="{StaticResource Primary}" TextColor="{StaticResource White}" Clicked="QuickNewMember_Clicked" x:Name="QuickNewMemberButton" />
            <!-- Snelle link naar instellingen behouden in footer als gemak (kan worden verwijderd indien ongewenst) -->
            <Button x:Name="FooterSettingsButton" Text="{Binding FooterSettingsText, Source={x:Reference This}}" BackgroundColor="{StaticResource Primary}" TextColor="{StaticResource White}" Command="{Binding Source={x:Static local:AppShell.Instance}, Path=OpenSettingsCommand}" />
        </VerticalStackLayout>
    </Shell.FlyoutFooter>

</Shell>
